<div class="guide">

<mat-tab-group [selectedIndex]="tabIndex" (selectedTabChange)=onTabChanged($event)>
    <mat-tab label="Inputs">
        <ng-template matTabContent>

<br />

<div>
  <button mat-raised-button color="primary" (click)="onClickNow()" >Now (default)</button>
</div>


<br /> 

<form class="guide-form">
  <mat-form-field class="guide-full-width">
    <input matInput placeholder="Start Time" [value]="startTimeInput" (input)="startTimeInput = $event.target.value">
  </mat-form-field>
  
  <mat-form-field class="guide-full-width">
    <input matInput placeholder="End Time" [value]="endTimeInput" (input)="endTimeInput = $event.target.value">
  </mat-form-field>
  
  <mat-form-field class="guide-full-width">
    <input matInput placeholder="Channel Id" [value]="chanIdInput" (input)="chanIdInput = $event.target.value">
  </mat-form-field>
    
</form>

<div>
  <button mat-raised-button color="primary" (click)="onClickGo()" >Go</button>
</div>

  </ng-template>
</mat-tab>

<mat-tab label="Guide" *ngIf="guideTabEnabled">
  <ng-template matTabContent>
	


<div *ngIf="!dataLoaded">
Loading...
</div>

<div *ngIf="dataLoaded">

<div *ngIf="byTimeLayout">

<div class="guide-header">{{selectedTimeString | date:'medium'}}</div>

<table mat-table [dataSource]="guideChannels" class="mat-elevation-z8 guide-full-width">
  <ng-container matColumnDef="channel">
    <th mat-header-cell *matHeaderCellDef> Channel </th>
    <td mat-cell *matCellDef="let ch" (click)="onSelectChannel(ch)" >{{ch.ChanNum}} - {{ch.ChannelName}}</td>
  </ng-container>

  <ng-container matColumnDef="program">
    <th mat-header-cell *matHeaderCellDef> Program </th>
    <td mat-cell *matCellDef="let ch" (click)="onSelectProgram(ch.Programs[0],ch.ChanId)">{{ch.Programs[0].Title}}</td>
  </ng-container>
    
  <tr mat-header-row *matHeaderRowDef="byTimeColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: byTimeColumns;"></tr>

<!--
<tr>
<th>Channel</th>
<th>Program</th>
</tr>
<tr *ngFor="let ch of guideChannels; last as last">
<td (click)="onSelectChannel(ch)">{{ch.ChanNum}} - {{ch.ChannelName}}</td>
<td *ngIf="ch.Programs.length > 0" (click)="onSelectProgram(ch.Programs[0],ch.ChanId)">{{ch.Programs[0].Title}}</td>
</tr>
--> 

</table>

</div>


<div *ngIf="!byTimeLayout">

<div class="guide-header">{{selectedChannel.ChanNum}} - {{selectedChannel.ChannelName}}</div>
 
<table mat-table [dataSource]="guidePrograms" class="mat-elevation-z8 guide-full-width">
  <ng-container matColumnDef="time">
    <th mat-header-cell *matHeaderCellDef> Time </th>
    <td mat-cell *matCellDef="let p" (click)="onSelectTime(p.StartTime)" >{{p.StartTime | date:'mediumDate'}}<br />{{p.StartTime | date:'mediumTime'}}</td>
  </ng-container>

  <ng-container matColumnDef="program">
    <th mat-header-cell *matHeaderCellDef> Program </th>
    <td mat-cell *matCellDef="let p" (click)="onSelectProgram(p)">{{p.Title}}</td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="byChannelColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: byChannelColumns;"></tr>
  
<!--
<tr>
<th>Time</th>
<th>Program</th>
</tr>

<tr *ngFor="let p of guidePrograms; last as last">
<td (click)="onSelectTime(p.StartTime)">{{p.StartTime | date:'medium'}}</td>
<td (click)="onSelectProgram(p)">{{p.Title}}</td>
</tr>
-->

</table>

</div>
</div>

</ng-template>
</mat-tab>

  <mat-tab label="Detail" *ngIf="selectedProgram">
    <ng-template matTabContent>

    
<app-program-detail [program]="selectedProgram"></app-program-detail>


</ng-template>
</mat-tab>

</mat-tab-group>

</div>